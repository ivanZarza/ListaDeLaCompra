import{b as t,_ as T,x as E,c as p,a as e,F as g,r as I,f as w,o as m,t as n,p as L,d as k,g as y}from"./index-Du6GS4nX.js";import{s as P}from"./servicioRecetasLogeado-DIgs21ug.js";import{V}from"./VentanaToast-Bwk1dkzL.js";const A={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"http://api-tucompra.izarza.dev"},{VITE_API_URL:N}=A;class x{constructor(){this.datosUsuario=t([]),this.recetasUsuario=t([]),this.ingredientesUsuario=t([])}async obtenerDatosUsuario(){try{const a=await fetch(`${N}/api/listadelacompra/me/datos`,{credentials:"include"});if(!a.ok){const v=await a.json();throw new Error(v.error||`Error al obtener los datos  ${a.status}`)}const i=await a.json();return this.datosUsuario.value=i.usuario,this.recetasUsuario.value=i.recetas,this.ingredientesUsuario.value=i.ingredientes,i}catch(a){throw console.error("Error al obtener los datos del usuario:",a),a}}}const C=new x,_=u=>(L("data-v-6723cec9"),u=u(),k(),u),O={class:"container"},B={class:"bienvenida"},j=_(()=>e("h3",null,"Aquí podrás recuperar tus recetas guardadas, también podrás crear, modificar o eliminar tus propios ingredientes",-1)),J={class:"contenidoUsuario"},$={class:"recetas"},z=_(()=>e("h1",null,"Recetas creadas por ti",-1)),F={class:"postalRecetas"},M=_(()=>e("h3",null,"¿Quieres pasar esta receta a la lista de la compra?",-1)),Q=["onClick"],q=_(()=>e("h3",null,"¿Quieres borrar la receta de la base de datos?",-1)),G=["onClick"],H={class:"ingredientes"},K=_(()=>e("h3",null,"Ingredientes creados por ti",-1)),W={class:"postales"},X={__name:"DatosLogeadoView",setup(u){const a=P,i=y(),v=t({}),h=t([]),b=t([]),U=t(!1),d=t(""),D=async()=>{try{const s=C;await s.obtenerDatosUsuario(),v.value=s.datosUsuario;const c=s.recetasUsuario,o=s.ingredientesUsuario;return h.value=c.value.map(r=>{let l=JSON.parse(r.datosJSON);return{id:r.id,usuarioId:r.usuarioId,nombre:l.nombre,numeroDePersonas:l.numeroDePersonas,principal:l.principal,acompanamiento:l.acompanamiento,condimentos:l.condimentos,descripcion:l.descripcion}}),b.value=o.value,h.value,b.value}catch(s){d.value=s.message,f(),setTimeout(()=>{i.push({name:"login"})},2100)}};function R(s){let c=JSON.parse(localStorage.getItem("recetasUsuario"))||[];c.find(r=>r.nombre===s.nombre)?d.value="La receta ya existe en la lista de la compra":(c.push({nombre:s.nombre,numeroDePersonas:s.numeroDePersonas,principal:s.principal,acompanamiento:s.acompanamiento,condimentos:s.condimentos,descripcion:s.descripcion,id:s.id,usuarioId:s.usuarioId}),localStorage.setItem("recetasUsuario",JSON.stringify(c)),d.value="Receta añadida a la lista de la compra"),f()}function S(s){a.borrarRecetaUsuario(s),d.value="Receta eliminada de la base de datos",f(),setTimeout(()=>{D()},2100)}function f(){U.value=!0,setTimeout(()=>{U.value=!1},2e3)}return E(D),(s,c)=>(m(),p(g,null,[e("div",O,[e("div",B,[j,e("div",J,[e("div",$,[z,(m(!0),p(g,null,I(h.value,o=>(m(),p("div",{key:o.id},[e("div",F,[e("h3",null,"Nombre: "+n(o.nombre)+" para "+n(o.numeroDePersonas)+" personas",1),M,e("button",{onClick:r=>R(o)},"SI",8,Q),q,e("button",{onClick:r=>S(o.id)},"BORRAR RECETA",8,G)])]))),128))]),e("div",H,[K,e("div",W,[(m(!0),p(g,null,I(b.value,o=>(m(),p("div",{class:"postalIngredientes",key:o.nombre},[e("p",null,"Nombre: "+n(o.nombre),1),e("p",null,"Tipo: "+n(o.tipo),1),e("p",null,"Principal: "+n(o.principal),1),e("p",null,"Acompañamiento: "+n(o.acompañamiento),1),e("p",null,"Condimento: "+n(o.condimento),1)]))),128))])])])])]),e("div",null,[w(V,{verToast:U.value,mensajeToast:d.value},null,8,["verToast","mensajeToast"])])],64))}},se=T(X,[["__scopeId","data-v-6723cec9"]]);export{se as default};
